# Migration `20201130175458-init`

This migration has been generated by Kacper Malkowski at 11/30/2020, 6:54:58 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "User" (
    "uuid" TEXT NOT NULL,
    "username" TEXT NOT NULL,
    "firstName" TEXT NOT NULL,
    "lastName" TEXT NOT NULL,
    "email" TEXT NOT NULL,
    "password" TEXT NOT NULL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,

    PRIMARY KEY ("uuid")
)

CREATE TABLE "Board" (
    "uuid" TEXT NOT NULL,
    "name" TEXT NOT NULL,

    PRIMARY KEY ("uuid")
)

CREATE TABLE "Column" (
    "uuid" TEXT NOT NULL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,
    "boardUuid" TEXT NOT NULL,

    PRIMARY KEY ("uuid")
)

CREATE TABLE "Task" (
    "uuid" TEXT NOT NULL,
    "author" TEXT NOT NULL,
    "title" TEXT NOT NULL,
    "description" TEXT NOT NULL,
    "position" INTEGER NOT NULL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,
    "columnUuid" TEXT NOT NULL,

    PRIMARY KEY ("uuid")
)

CREATE TABLE "_BoardToUser" (
    "A" TEXT NOT NULL,
    "B" TEXT NOT NULL
)

CREATE UNIQUE INDEX "User.username_unique" ON "User"("username")

CREATE UNIQUE INDEX "User.email_unique" ON "User"("email")

CREATE UNIQUE INDEX "_BoardToUser_AB_unique" ON "_BoardToUser"("A", "B")

CREATE INDEX "_BoardToUser_B_index" ON "_BoardToUser"("B")

ALTER TABLE "Column" ADD FOREIGN KEY("boardUuid")REFERENCES "Board"("uuid") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Task" ADD FOREIGN KEY("columnUuid")REFERENCES "Column"("uuid") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "_BoardToUser" ADD FOREIGN KEY("A")REFERENCES "Board"("uuid") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "_BoardToUser" ADD FOREIGN KEY("B")REFERENCES "User"("uuid") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20201130175458-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,51 @@
+// This is your Prisma schema file,
+// learn more about it in the docs: https://pris.ly/d/prisma-schema
+
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+model User {
+  uuid      String    @id @default(uuid())
+  username  String      @unique
+  firstName String
+  lastName  String
+  email     String      @unique
+  password  String
+  createdAt DateTime    @default(now())
+  updatedAt DateTime    @updatedAt
+  boards    Board[]
+}
+
+model Board {
+  uuid      String    @id @default(uuid())
+  name      String
+  users     User[]
+  columns   Column[]
+}
+
+model Column {
+  uuid      String    @id @default(uuid())
+  createdAt DateTime    @default(now())
+  updatedAt DateTime    @updatedAt
+  board     Board       @relation(fields: [boardUuid], references: [uuid])
+  boardUuid String
+  tasks     Task[]
+}
+
+model Task {
+  uuid          String    @id @default(uuid())
+  author        String
+  title         String
+  description   String
+  position      Int
+  createdAt     DateTime    @default(now())
+  updatedAt     DateTime    @updatedAt
+  column        Column      @relation(fields: [columnUuid], references: [uuid])
+  columnUuid    String
+}
```


